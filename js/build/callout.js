!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CKEditor5=t():(e.CKEditor5=e.CKEditor5||{},e.CKEditor5.callout=t())}(self,(()=>(()=>{var e=[e=>{"use strict";e.exports=CKEditor5.dll},(e,t,i)=>{e.exports=i(0)("./src/core.js")},(e,t,i)=>{e.exports=i(0)("./src/ui.js")},,(e,t,i)=>{e.exports=i(0)("./src/widget.js")},(e,t,i)=>{e.exports=i(0)("./src/utils.js")}],t={};function i(o){var s=t[o];if(void 0!==s)return s.exports;var l=t[o]={exports:{}};return e[o](l,l.exports,i),l.exports}i.d=(e,t)=>{for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var o={};return(()=>{"use strict";i.d(o,{default:()=>w});var e=i(1);const t={xlarge:{label:"Extra Large",icon:e.icons.large,className:"feature-layout-callout-xlarge"},large:{label:"Large",icon:e.icons.regular,className:"feature-layout-callout-large"},medium:{label:"Medium",icon:e.icons.small,className:"feature-layout-callout-medium"}},s="medium";class l extends e.Command{constructor(e){super(e),this.set("existingCalloutSelected",!1)}execute({size:e=s,calloutText:t}){const i=this.editor.model,o=i.document.selection;i.change((s=>{o.getFirstRange();const l=s.createElement("cuCallout",{cuCalloutSize:e});s.insert(t,l),i.insertContent(l)}))}refresh(){const e=this.editor.model,t=e.document.selection,i=t.getSelectedElement(),o=e.schema.findAllowedParent(t.getFirstPosition(),"cuCallout");var s;this.isEnabled=null!==o,this.existingCalloutSelected=(s=i)&&"cuCallout"===s.name?i:null}}var n=i(4);class a extends e.Plugin{static get requires(){return[n.Widget]}init(){this._defineSchema(),this._defineConverters(),this.editor.commands.add("addCallout",new l(this.editor))}_defineSchema(){this.editor.model.schema.register("cuCallout",{allowWhere:"$text",isObject:!0,isInline:!0,allowAttributes:["cuCalloutSize"],allowContentOf:"$block"})}_defineConverters(){const{conversion:e}=this.editor;e.attributeToAttribute(function(e,t){const i={};for(const[e,o]of Object.entries(t))i[e]={key:"class",value:o.className};return{model:{key:e,values:Object.keys(t)},view:i}}("cuCalloutSize",t)),e.for("upcast").elementToElement({model:"cuCallout",view:{name:"div",classes:"feature-layout-callout"}}),e.for("dataDowncast").elementToElement({model:"cuCallout",view:{name:"div",classes:"feature-layout-callout"}}),e.for("editingDowncast").elementToElement({model:"cuCallout",view:(e,{writer:t})=>(0,n.toWidget)(t.createContainerElement("div",{class:"feature-layout-callout"}),t,{label:"Callout Widget"})})}}var c=i(2),r=i(5);class u extends c.View{constructor(i,o){super(i),this.focusTracker=new r.FocusTracker,this.keystrokes=new r.KeystrokeHandler,this.sizeDropdown=this._createSelectionDropdown(i,"Size",t[s].icon,"size",t,s),this.calloutTextInputView=this._createInput("Add Callout Text"),this.set("size",s),this.calloutTextInputView.fieldView.bind("calloutText").to(this,"calloutText"),this.set("calloutText",""),this.saveButtonView=this._createButton("Save",e.icons.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton("Cancel",e.icons.cancel,"ck-button-cancel"),this.cancelButtonView.delegate("execute").to(this,"cancel"),this.childViews=this.createCollection([this.sizeDropdown,this.calloutTextInputView,this.saveButtonView,this.cancelButtonView]),this._focusCycler=new c.FocusCycler({focusables:this.childViews,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-callout-form"],tabindex:"-1"},children:this.childViews})}render(){super.render(),(0,c.submitHandler)({view:this}),this.childViews._items.forEach((e=>{this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.calloutTextInputView.isEnabled,this.calloutTextInputView.focus()}_createInput(e){const t=new c.LabeledFieldView(this.locale,c.createLabeledInputText);return t.label=e,t}_createButton(e,t,i){const o=new c.ButtonView;return o.set({label:e,icon:t,tooltip:!0,class:i}),o}_createSelectionDropdown(e,t,i,o,s,l){const n=(0,c.createDropdown)(e),a=s[l];return(0,c.addToolbarToDropdown)(n,Object.entries(s).map((([t,i])=>this._createSelectableButton(e,i.label,i.icon,o,t)))),n.buttonView.set({icon:i,tooltip:e.t(t),withText:!i}),n.buttonView.bind("label").to(this,o,(t=>e.t(s[t]?s[t].label:a.label))),i===s[l].icon&&n.buttonView.bind("icon").to(this,o,(e=>s[e]?s[e].icon:a.icon)),n}_createSelectableButton(e,t,i,o,s){const l=new c.ButtonView;return l.set({label:e.t(t),icon:i,tooltip:!!i,isToggleable:!0,withText:!i}),l.bind("isOn").to(this,o,(e=>e===s)),this.listenTo(l,"execute",(()=>{this.set(o,s)})),l}}class d extends e.Plugin{static get requires(){return[c.ContextualBalloon]}static get pluginName(){return"CalloutUI"}init(){const e=this.editor,t=e.ui.componentFactory,i=e.commands.get("addCallout"),o=e.editing.view.document;this._balloon=this.editor.plugins.get(c.ContextualBalloon),this.formView=this._createFormView(e.locale),this.buttonView=null,t.add("callout",(e=>{const t=new c.ButtonView(e);t.label="Callout",t.icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --\x3e<path d="M217.9 105.9L340.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L217.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1L32 320c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM352 416l64 0c17.7 0 32-14.3 32-32l0-256c0-17.7-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32s14.3-32 32-32l64 0c53 0 96 43 96 96l0 256c0 53-43 96-96 96l-64 0c-17.7 0-32-14.3-32-32s14.3-32 32-32z"/></svg>',t.tooltip=!0,t.withText=!1,t.isToggleable=!0,this.listenTo(t,"execute",(()=>{this._showUI(i.existingCalloutSelected)})),this.buttonView=t;const s=()=>{const e=i.existingCalloutSelected;t.isOn=!!e};return this.listenTo(i,"change:value",s),this.listenTo(i,"change:existingCalloutSelected",s),this.listenTo(o,"click",(()=>{i.existingCalloutSelected&&this._showUI(i.existingCalloutSelected)})),this.on("showUI",((e,t)=>{this._showUI(t)})),t.bind("isOn","isEnabled").to(i,"value","isEnabled"),t}))}_createFormView(e){const t=this.editor,i=t.ui.componentFactory,o=new u(e,i);return this.listenTo(o,"submit",(()=>{const e={calloutText:o.calloutTextInputView.fieldView.element.value,size:o.size};t.execute("addCallout",e),this._hideUI()})),this.listenTo(o,"cancel",(()=>{this._hideUI()})),o.keystrokes.set("Esc",((e,t)=>{this._hideUI(),t()})),(0,c.clickOutsideHandler)({emitter:o,activator:()=>this._balloon.visibleView===o,contextElements:[this._balloon.view.element],callback:()=>this._hideUI()}),o}_showUI(e){this.buttonView.isOn=!0,this._balloon.visibleView&&this._hideUI();const t=this.editor.commands.get("addCallout").value;if(this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),e){const t=e.getAttribute("cuCalloutSize"),i=e.getChild(0);if(i&&i.data){const e=i.data;this.formView.size=t,this.formView.calloutTextInputView.fieldView.value=e,this.formView.calloutTextInputView.fieldView.element.value=e,this.formView.calloutTextInputView.fieldView.set("value",e)}}t&&(this.formView.calloutTextInputView.fieldView.value=t.calloutText,this.formView.sizeDropdown.fieldView.value=t.size),setTimeout((()=>{this.formView.calloutTextInputView.fieldView.focus()}),0)}_hideUI(){this._balloon.hasView(this.formView)&&(this.formView.element.reset(),this.buttonView.isOn=!1,this._balloon.remove(this.formView),this.editor.editing.view.focus())}_getBalloonPositionData(){const e=this.editor.editing.view,t=e.document;let i=null;return i=()=>e.domConverter.viewRangeToDom(t.selection.getFirstRange()),{target:i}}}class h extends e.Plugin{static get requires(){return[a,d]}}const w={Callout:h}})(),o=o.default})()));