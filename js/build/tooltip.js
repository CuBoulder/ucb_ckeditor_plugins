!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.CKEditor5=e():(t.CKEditor5=t.CKEditor5||{},t.CKEditor5.tooltip=e())}(self,()=>(()=>{var t=[t=>{"use strict";t.exports=CKEditor5.dll},(t,e,i)=>{t.exports=i(0)("./src/core.js")},(t,e,i)=>{t.exports=i(0)("./src/utils.js")},(t,e,i)=>{t.exports=i(0)("./src/ui.js")}],e={};function i(o){var s=e[o];if(void 0!==s)return s.exports;var n=e[o]={exports:{}};return t[o](n,n.exports,i),n.exports}i.d=(t,e)=>{for(var o in e)i.o(e,o)&&!i.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var o={};return(()=>{"use strict";i.d(o,{default:()=>b});var t=i(1);function e(t,e,i,o){return o.createRange(s(t,e,i,!0,o),s(t,e,i,!1,o))}function s(t,e,i,o,s){let n=t.textNode||(o?t.nodeBefore:t.nodeAfter),r=null;for(;n&&n.getAttribute(e)==i;)r=n,n=o?n.previousSibling:n.nextSibling;return r?s.createPositionAt(r,o?"before":"after"):t}function n(t){return Array.from(t.getItems()).reduce((t,e)=>e.is("text")||e.is("textProxy")?t+e.data:t,"")}var r=i(2);class l extends t.Command{refresh(){const t=this.editor.model,i=t.document.selection,o=i.getFirstRange();if(o.isCollapsed)if(i.hasAttribute("tooltip")){const o=i.getAttribute("ucb-tooltip"),s=e(i.getFirstPosition(),"ucb-tooltip",o,t);this.value={abbr:n(s),title:o,range:s}}else this.value=null;else if(i.hasAttribute("ucb-tooltip")){const s=i.getAttribute("ucb-tooltip");e(i.getFirstPosition(),"ucb-tooltip",s,t).containsRange(o,!0)?this.value={abbr:n(o),title:s,range:o}:this.value=null}else this.value=null;this.isEnabled=t.schema.checkAttributeInSelection(i,"ucb-tooltip")}execute({abbr:t,title:e}){const i=this.editor.model,o=i.document.selection;i.change(s=>{if(o.isCollapsed){if(this.value){const{end:o}=i.insertContent(s.createText(t,{tooltip:e}),this.value.range);s.setSelection(o)}else if(""!==t){const n=o.getFirstPosition(),l=(0,r.toMap)(o.getAttributes());l.set("ucb-tooltip",e);const{end:a}=i.insertContent(s.createText(t,l),n);s.setSelection(a)}s.removeSelectionAttribute("ucb-tooltip")}else{const t=i.schema.getValidRanges(o.getRanges(),"ucb-tooltip");for(const i of t)s.setAttribute("ucb-tooltip",e,i)}})}}class a extends t.Plugin{init(){this._defineSchema(),this._defineConverters(),this.editor.commands.add("addTooltip",new l(this.editor))}_defineSchema(){const t=this.editor.model.schema;t.register("ucb-tooltip",{isContent:!0}),t.extend("$text",{allowAttributes:["ucb-tooltip"]})}_defineConverters(){const t=this.editor.conversion;t.for("downcast").attributeToElement({model:"ucb-tooltip",view:(t,e)=>{const{writer:i}=e;return i.createAttributeElement("abbr",{title:t,class:"ucb-tooltip"})}}),t.for("upcast").elementToAttribute({view:{name:"abbr",attributes:["title"],classes:"ucb-tooltip"},model:{key:"ucb-tooltip",value:t=>t.getAttribute("title")}})}}var c=i(3);class u extends c.View{constructor(t){super(t),this.focusTracker=new r.FocusTracker,this.keystrokes=new r.KeystrokeHandler,this.abbrInputView=this._createInput("Add Tooltip"),this.titleInputView=this._createInput("Add Text"),this.saveButtonView=this._createButton("Save",'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>',"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton("Cancel",'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.591 10.177 4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>',"ck-button-cancel"),this.cancelButtonView.delegate("execute").to(this,"cancel"),this.childViews=this.createCollection([this.abbrInputView,this.titleInputView,this.saveButtonView,this.cancelButtonView]),this._focusCycler=new c.FocusCycler({focusables:this.childViews,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-tooltip-form"],tabindex:"-1"},children:this.childViews})}render(){super.render(),(0,c.submitHandler)({view:this}),this.childViews._items.forEach(t=>{this.focusTracker.add(t.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.abbrInputView.isEnabled?this.abbrInputView.focus():this.titleInputView.focus()}_createInput(t){const e=new c.LabeledFieldView(this.locale,c.createLabeledInputText);return e.label=t,e}_createButton(t,e,i){const o=new c.ButtonView;return o.set({label:t,icon:e,tooltip:!0,class:i}),o}}class d extends t.Plugin{static get requires(){return[c.ContextualBalloon]}init(){const t=this.editor;this._balloon=this.editor.plugins.get(c.ContextualBalloon),this.formView=this._createFormView(),t.ui.componentFactory.add("tooltip",()=>{const t=new c.ButtonView;return t.label="Tooltip",t.icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!-- Font Awesome Pro 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) --\x3e<path d="M448 0H64C28.7 0 0 28.7 0 64v288c0 35.3 28.7 64 64 64h96v84c0 7.1 5.8 12 12 12 2.4 0 4.9-.7 7.1-2.4L304 416h144c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64zm32 352c0 17.6-14.4 32-32 32H293.3l-8.5 6.4L192 460v-76H64c-17.6 0-32-14.4-32-32V64c0-17.6 14.4-32 32-32h384c17.6 0 32 14.4 32 32v288zM128 184c-13.3 0-24 10.7-24 24s10.7 24 24 24 24-10.7 24-24-10.7-24-24-24zm128 0c-13.3 0-24 10.7-24 24s10.7 24 24 24 24-10.7 24-24-10.7-24-24-24zm128 0c-13.3 0-24 10.7-24 24s10.7 24 24 24 24-10.7 24-24-10.7-24-24-24z"/></svg>',t.tooltip=!0,t.withText=!1,this.listenTo(t,"execute",()=>{this._showUI()}),t})}_createFormView(){const t=this.editor,e=new u(t.locale);return this.listenTo(e,"submit",()=>{const i={abbr:e.abbrInputView.fieldView.element.value,title:e.titleInputView.fieldView.element.value};t.execute("addTooltip",i),this._hideUI()}),this.listenTo(e,"cancel",()=>{this._hideUI()}),(0,c.clickOutsideHandler)({emitter:e,activator:()=>this._balloon.visibleView===e,contextElements:[this._balloon.view.element],callback:()=>this._hideUI()}),e}_showUI(){const t=this.editor.model.document.selection,e=this.editor.commands.get("addTooltip").value;if(this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this.formView.abbrInputView.isEnabled=t.getFirstRange().isCollapsed,e)this.formView.abbrInputView.fieldView.value=e.abbr,this.formView.titleInputView.fieldView.value=e.title;else{const e=n(t.getFirstRange());this.formView.abbrInputView.fieldView.value=e,this.formView.titleInputView.fieldView.value=""}this.formView.focus()}_hideUI(){this.formView.abbrInputView.fieldView.value="",this.formView.titleInputView.fieldView.value="",this.formView.element.reset(),this._balloon.remove(this.formView),this.editor.editing.view.focus()}_getBalloonPositionData(){const t=this.editor.editing.view,e=t.document;let i=null;return i=()=>t.domConverter.viewRangeToDom(e.selection.getFirstRange()),{target:i}}}class h extends t.Plugin{static get requires(){return[a,d]}}const b={Tooltip:h}})(),o=o.default})());